# 图像分类模型训练

这是一个用于图像分类模型训练的Python脚本。它使用PyTorch和一些常见的库来加载数据、定义模型、进行训练和验证。

## 准备所需的库和模块

- `torchutils`: 这是自定义的模块，用于包含一些工具函数。
- `torchvision`: 用于处理图像数据和预定义的深度学习模型。
- `os.path`: 用于处理文件路径。
- `os`: 用于操作文件系统。
- 其他标准Python库和模块。

## 超参数设置

在脚本中，有一些超参数设置，例如模型名称、图像输入大小、数据集路径、学习率、批量大小、轮数等等。这些超参数决定了训练过程的配置。

## 定义模型

脚本中定义了一个名为`SELFMODEL`的PyTorch模型，用于图像分类任务。该模型基于指定的预训练模型（如ResNet）创建，并修改了最后一层全连接层以适应所需的类别数目。

## 训练流程

训练流程包括以下步骤：

1. 加载训练数据集和验证数据集，并对其进行数据预处理。
2. 创建模型实例，设置损失函数和优化器。
3. 进行多个轮次的训练，包括前向传播、计算损失、反向传播和权重更新。
4. 逐个轮次更新训练指标，如损失、F1分数、召回率和准确率。
5. 在训练过程中，学习率可能会动态调整。
6. 保存在验证集上性能最佳的模型。

## 验证流程

验证流程与训练流程类似，但在验证集上进行前向传播和性能度量，而不进行权重更新，这可以评估模型的性能。

## 展示训练过程的曲线

脚本还包含一个用于绘制训练过程中准确率和损失的曲线的函数，有助于可视化训练进展和性能。

## 遇到的问题和解决方法

- **模型选择**：因网络问题无法通过`torchvision`自动下载选择适合任务的预训练模型，可在网络搜索云盘资源或其他镜像链接下载后从本地导入并做相应的修改（如pretrained）。

- **学习率和超参数**：模型性能不佳，调整学习率、批大小和其他超参数以获得最佳性能。

- **内存问题**：GPU无法分配出足够内存，根据计算资源，可能需要适当调整批大小和数据加载器。
