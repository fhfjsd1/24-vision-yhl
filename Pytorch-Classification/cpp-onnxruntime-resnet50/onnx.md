# 图像分类模型推理

这个C++程序使用ONNX Runtime库执行图像分类模型的推理。它加载一个预训练的深度学习模型，并使用它来对输入图像进行分类，然后输出前5个可能的类别。

## 使用的库和模块

- **ONNX Runtime**: 用于加载和运行ONNX模型。
- **iostream**: 用于控制台输出。
- **Helpers.cpp**: 自定义函数，用于加载图像和标签。

## 输入数据

- **模型**: 定义了一个ONNX模型文件的路径，这是训练好的图像分类模型。
- **标签文件**: 包含了图像类别标签的文件的路径。
- **图像文件**: 需要进行分类的输入图像的文件路径。

## 推理过程

1. 创建ONNX Runtime的环境和运行选项。
2. 加载ONNX模型。
3. 加载标签文件，以便在最终输出中显示类别标签。
4. 加载输入图像。
5. 执行模型推理，将输入图像传递给模型，并获得输出结果。
6. 对输出结果进行排序，找到前5个可能的类别。
7. 输出前5个类别及其概率。

## 遇到的问题和解决方法

- **输入图像格式**: 更换模型后推理错误。确保输入图像是224x224的RGB图像，与模型期望的格式匹配。这要求在更换模型时需要关注更换模型训练过程中输入数据预处理方式与推理例程中的数据预处理方式是否相同。

- **运行环境问题**: 找不到头文件。确保已正确设置ONNX Runtime环境，包括CPU或GPU支持。由于采用预编译包安装，很多库和头文件被删减，导致代码写作空间有限，只能更改代码

- **Cmake异常处理**: 找不到package。包所在路径缺少`CMakecCnfig`等文件，在某不知名仓库的issue里找到代码补充。

- **依赖库**: 参考例程部分函数无效。参考例程版本较低，在新版本onnx中已经删除部分函数，需要自行修改代码。
